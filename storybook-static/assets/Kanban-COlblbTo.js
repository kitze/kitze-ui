import{j as n}from"./jsx-runtime-DPtPVAOg.js";import{u as I,C,a as j,T as S,b as T,S as q,v as k,c as D,d as R,D as O,p as z,e as K,P as _}from"./index-BylELqKr.js";import{r as f}from"./index-BAAwwy_G.js";import{c as y}from"./cn-BQIMLNQW.js";const x=({id:t,children:a})=>{const{attributes:i,listeners:d,setNodeRef:u,transform:r,transition:g,isDragging:o}=I({id:t}),p={transform:C.Transform.toString(r),transition:g};return n.jsx("div",{ref:u,style:p,...i,...d,className:y("!cursor-grab active:!cursor-grabbing touch-none transition-all duration-200",o&&"opacity-0"),children:a})};x.__docgenInfo={description:"",methods:[],displayName:"KanbanItem"};function E(t,a){const i=`persisted_state_${t}`,[d,u]=f.useState(()=>{if(typeof window>"u")return a;try{const r=window.localStorage.getItem(i);return r?JSON.parse(r):a}catch(r){return console.warn(`Error reading localStorage key "${i}":`,r),a}});return f.useEffect(()=>{try{window.localStorage.setItem(i,JSON.stringify(d))}catch(r){console.warn(`Error setting localStorage key "${i}":`,r)}},[i,d]),[d,u]}const N=f.memo(({config:t,items:a,renderItem:i,onAddNew:d,isOver:u,kanbanId:r})=>{const{setNodeRef:g}=j({id:t.id}),[o,p]=E(`${r}_column_${t.id}_collapsed`,!1),[w,v]=f.useState({}),b=(s,e)=>{v(l=>({...l,[s]:e}))};return n.jsxs("div",{className:y("vertical space-y-4 first:pl-6 last:pr-6 select-none transition-all duration-200",o?"w-12 !p-0 !ml-0 !-mr-6":"min-w-[85vw] md:min-w-[300px] w-[85vw] md:w-[300px]"),children:[n.jsxs("div",{className:y("horizontal cursor-pointer items-center",o?"flex-col space-y-2 rotate-90 translate-y-4 align-top justify-start items-start":"justify-between"),children:[n.jsxs("div",{onClick:()=>{o&&p(!1)},className:y("horizontal items-center space-x-2"),children:[n.jsx("div",{className:y("w-2 h-2 rounded-full",t.classNames.circle)}),n.jsx("h2",{className:"font-medium whitespace-nowrap",children:t.title}),!o&&n.jsxs("div",{className:"text-sm text-zinc-400",children:["(",a.length,")"]})]}),n.jsxs("div",{className:"horizontal space-x-2",children:[!o&&n.jsx("button",{onClick:()=>p(s=>!s),className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800",children:n.jsx(S,{size:20,className:y("text-zinc-500 transition-transform",o&&"rotate-180")})}),!o&&d&&n.jsx("button",{onClick:d,className:"p-1 rounded-full hover:bg-zinc-100 dark:hover:bg-zinc-800",children:n.jsx(T,{size:20,className:"text-zinc-500"})})]})]}),!o&&n.jsx("div",{ref:g,className:y("vertical space-y-3 p-4 rounded-lg h-full overflow-y-auto transition-colors duration-200",t.classNames.card,u&&t.classNames.cardWhenOver),children:n.jsx(q,{items:a.map(s=>s.id),strategy:k,children:a.map(s=>n.jsx(x,{id:s.id,children:i(s,e=>b(s.id,e))},s.id))})})]})});N.__docgenInfo={description:"",methods:[],displayName:"KanbanColumn",props:{config:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  id: T;
  title: string;
  classNames: KanbanColumnClassNames;
}`,signature:{properties:[{key:"id",value:{name:"T",required:!0}},{key:"title",value:{name:"string",required:!0}},{key:"classNames",value:{name:"signature",type:"object",raw:`{
  card?: string;
  cardWhenOver?: string;
  circle?: string;
}`,signature:{properties:[{key:"card",value:{name:"string",required:!1}},{key:"cardWhenOver",value:{name:"string",required:!1}},{key:"circle",value:{name:"string",required:!1}}]},required:!0}}]}},description:""},items:{required:!0,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:`(
  item: any,
  setDraggable: (isDraggable: boolean) => void
) => React.ReactNode`,signature:{arguments:[{type:{name:"any"},name:"item"},{type:{name:"signature",type:"function",raw:"(isDraggable: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isDraggable"}],return:{name:"void"}}},name:"setDraggable"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},onAddNew:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},isOver:{required:!1,tsType:{name:"boolean"},description:""},kanbanId:{required:!0,tsType:{name:"T"},description:""}}};const W=({items:t,config:a,renderItem:i})=>{const[d,u]=f.useState(null),[r,g]=f.useState(null),o=D(R(_,{activationConstraint:{distance:8}})),p=e=>{const l=a.columns.find(m=>m.id===e);if(l)return l.id;const c=t.find(m=>m.id===e);return c?a.getColumnId(c):null},w=({active:e})=>{u(e.id)},v=({over:e})=>{var c;if(!e){g(null);return}const l=p(e.id);console.log("Drag over:",{overId:e==null?void 0:e.id,overData:(c=e==null?void 0:e.data)==null?void 0:c.current,columnId:l,isColumn:a.columns.some(m=>m.id===e.id)}),g(l)},b=e=>{const{active:l,over:c}=e;if(console.log("Drag end:",{activeId:l.id,overId:c==null?void 0:c.id,overColumn:r}),u(null),g(null),!c)return;const m=l.id,h=p(c.id);!h||m===h||a.updateItem(m,h)},s=t.find(e=>e.id===d);return n.jsxs(O,{sensors:o,onDragStart:w,onDragOver:v,onDragEnd:b,collisionDetection:z,children:[n.jsx("div",{className:"h-full w-full overflow-x-auto",children:n.jsx("div",{className:"h-full inline-flex gap-4 py-4 min-w-max",children:a.columns.map(e=>n.jsx(N,{config:e,items:t.filter(l=>a.getColumnId(l)===e.id),renderItem:i,kanbanId:e.id,isOver:r===e.id},e.id))})}),n.jsx(K,{className:"cursor-grabbing",children:d&&s&&i(s)})]})};W.__docgenInfo={description:"",methods:[],displayName:"Kanban",props:{items:{required:!0,tsType:{name:"Array",elements:[{name:"any"}],raw:"any[]"},description:""},config:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  columns: KanbanColumnConfig<T>[];
  getColumnId: (item: any) => T;
  updateItem: (itemId: string, columnId: T) => void;
}`,signature:{properties:[{key:"columns",value:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  id: T;
  title: string;
  classNames: KanbanColumnClassNames;
}`,signature:{properties:[{key:"id",value:{name:"T",required:!0}},{key:"title",value:{name:"string",required:!0}},{key:"classNames",value:{name:"signature",type:"object",raw:`{
  card?: string;
  cardWhenOver?: string;
  circle?: string;
}`,signature:{properties:[{key:"card",value:{name:"string",required:!1}},{key:"cardWhenOver",value:{name:"string",required:!1}},{key:"circle",value:{name:"string",required:!1}}]},required:!0}}]}}],raw:"KanbanColumnConfig<T>[]",required:!0}},{key:"getColumnId",value:{name:"signature",type:"function",raw:"(item: any) => T",signature:{arguments:[{type:{name:"any"},name:"item"}],return:{name:"T"}},required:!0}},{key:"updateItem",value:{name:"signature",type:"function",raw:"(itemId: string, columnId: T) => void",signature:{arguments:[{type:{name:"string"},name:"itemId"},{type:{name:"T"},name:"columnId"}],return:{name:"void"}},required:!0}}]}},description:""},renderItem:{required:!0,tsType:{name:"signature",type:"function",raw:"(item: any) => React.ReactNode",signature:{arguments:[{type:{name:"any"},name:"item"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""},enableDragging:{required:!1,tsType:{name:"boolean"},description:""}}};export{W as K};
